execute if score $number mode matches 0 as @a[gamemode=adventure,x=0,y=66,z=0,distance=..500] at @s unless entity @s[nbt={Inventory:[{Slot:4b,id:"minecraft:carrot_on_a_stick",tag:{CustomModelData:2}}]}] run function lobby:midgame/get_spec_book
execute if score $number mode matches 1 as @a[gamemode=adventure,x=0,y=66,z=0,distance=..500] at @s unless entity @s[nbt={Inventory:[{Slot:3b,id:"minecraft:carrot_on_a_stick",tag:{spectate:1,CustomModelData:2}}]}] run function lobby:midgame/get_spec_book_in_other_slot
execute if score $number mode matches 1 as @a[gamemode=adventure,x=0,y=66,z=0,distance=..500] at @s unless entity @s[nbt={Inventory:[{Slot:5b,id:"minecraft:carrot_on_a_stick",tag:{join:1,CustomModelData:2}}]}] run function lobby:midgame/get_join_book
execute as @a[gamemode=adventure,x=0,y=66,z=0,distance=..500,nbt={SelectedItem:{id:"minecraft:carrot_on_a_stick",tag:{spectate:1,CustomModelData:2}}},scores={right_click=1..}] at @s run function lobby:midgame/spectate
execute as @a[gamemode=adventure,x=0,y=66,z=0,distance=..500,nbt={SelectedItem:{id:"minecraft:carrot_on_a_stick",tag:{join:1,CustomModelData:2}}},scores={right_click=1..}] at @s run function lobby:midgame/join